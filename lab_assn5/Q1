#include <iostream>
using namespace std;
struct Node {
    int data;
    Node* next;
};
Node* head=NULL;
void insertBegin(int val) {
    Node* newNode=new Node{val,head};
    head=newNode;
}
void insertEnd(int val) {
    Node* newNode=new Node{val, NULL};
    if (!head) { 
      head=newNode;
      return; }
    Node* temp=head;
    while (temp->next){
      temp=temp->next;}
    temp->next=newNode;
}

void insertBefore(int key, int val) {
    if (!head){
      return;}
    if (head->data==key) { 
      insertBegin(val);
      return; }
    Node* temp =head;
    while (temp->next && temp->next->data != key){
      temp=temp->next;}
    if (temp->next) {
        Node* newNode=new Node{val, temp->next};
        temp->next=newNode;
    }
}
void insertAfter(int key, int val) {
    Node* temp=head;
    while (temp && temp->data != key) {
        temp = temp->next;}
    if (temp) {
        Node* newNode=new Node{val, temp->next};
        temp->next=newNode;
    }
}
void deleteBegin() {
    if (!head) return;
    Node* temp=head;
    head=head->next;
    delete temp;
}
void deleteEnd() {
    if (!head) return;
    if (!head->next) { 
      delete head; 
      head=NULL; 
      return; }
    Node* temp=head;
    while (temp->next->next){
       temp=temp->next;}
    delete temp->next;
    temp->next=NULL;
}


void deleteKey(int key) {
    if (!head) return;
    if (head->data==key) { 
      deleteBegin(); 
      return; }
    Node* temp=head;
    while (temp->next && temp->next->data != key) {
       temp=temp->next;}
    if (temp->next) {
        Node* del=temp->next;
        temp->next=del->next;
        delete del;
    }
}

void searchNode(int key) {
    Node* temp=head; 
    int pos=1;
    while (temp) {
        if (temp->data==key) { 
            cout<< "Found at position "<<pos<< endl; 
            return; 
        }
        temp=temp->next; pos++;
    }
    cout<<"Not found\n";
}

void display() {
    Node* temp=head;
    while (temp) { 
       cout<<temp->data<<" "; 
       temp=temp->next;}
    
}

int main() {
    int choice,val,key;

    while (true) {
        cout<<"\n1.Insert Begin 2.Insert End 3.Insert Before 4.Insert After\n";
        cout<<"5.Delete Begin 6.Delete End 7.Delete Key 8.Search 9.Display 10.Exit\n";
        cin>>choice;

        if (choice==1) { 
          cout<<"Value:";
          cin >> val; 
          insertBegin(val); }
        else if(choice==2) { 
          cout<<"Value"; 
          cin >> val; 
          insertEnd(val); }
        else if (choice==3) {
          cout<<"Key and Value:"; 
          cin>>key>>val; 
          insertBefore(key,val); }
        else if(choice== 4) {
          cout<<"Key and Value:"; 
          cin>>key>>val; 
          insertAfter(key,val); }
        else if(choice ==5) {deleteBegin();}
        else if (choice==6){ deleteEnd();}
        else if (choice==7) { 
          cout<<"Key"; 
          cin>>key; 
          deleteKey(key); }
        else if (choice==8) { cout << "Key: "; cin >> key; searchNode(key); }
        else if (choice==9){ display();}
        else if (choice==10) {break;}
    }
}
